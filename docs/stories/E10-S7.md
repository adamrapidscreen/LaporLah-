# E10-S7: Final Deployment and Verification

## Description
Deploy the complete LaporLah application to Vercel production, seed the production database, and verify the full user journey end-to-end including all major features. This is the final validation story before project handoff.

## Dependencies
- Stories: E1 through E10-S6 (all stories must be complete)
- Files: All application files, `scripts/seed.ts`, `.env.local.example`, `README.md`

## Tasks
1. **Vercel Deployment Setup**:
   - Connect GitHub repository to Vercel
   - Configure environment variables (NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY, SUPABASE_SERVICE_ROLE_KEY)
   - Set framework preset to Next.js
   - Deploy to production
2. **Production Database Seeding**:
   - Run seed script against production Supabase: `NEXT_PUBLIC_SUPABASE_URL=... SUPABASE_SERVICE_ROLE_KEY=... npm run seed`
   - Verify all seed data appears correctly in Supabase dashboard
3. **End-to-End Verification Flow**:
   - Sign in with Google OAuth
   - Create a new report with photo, location, category
   - View report in home feed
   - Open report detail page
   - Post a comment on the report
   - Follow the report
   - Propose status change to "resolved"
   - Cast a community confirmation vote
   - Verify badge is awarded after reaching threshold
   - View profile with points and badges
   - View notifications
   - Access admin dashboard (with admin role)
   - Flag a report/comment
   - Test on mobile device (375px viewport)
4. **Performance Check**:
   - Verify all pages load with skeleton states (no blank screens)
   - Check Lighthouse mobile score (target: Performance > 80, Accessibility > 90)
   - Verify images load from Supabase Storage
   - Verify maps render correctly
5. **Bug Fix & Polish**:
   - Document any issues found during verification
   - Fix critical bugs blocking the judge flow
   - Ensure all toast notifications fire correctly

## Implementation Notes

### Vercel Configuration
```bash
# Vercel Environment Variables to set:
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...
SUPABASE_SERVICE_ROLE_KEY=eyJ...
```

### Production Seed Command
```bash
# Set production env vars temporarily for seeding
NEXT_PUBLIC_SUPABASE_URL=https://prod-project.supabase.co \
SUPABASE_SERVICE_ROLE_KEY=eyJ... \
npx tsx scripts/seed.ts
```

### Judge Flow Verification Checklist
```
1. Authentication
   - [ ] Google OAuth sign-in works
   - [ ] User profile is created in users table
   - [ ] Redirect to home feed after sign-in

2. Report Creation
   - [ ] Navigate to /create
   - [ ] Fill in title, description, category
   - [ ] Upload photo (compresses and uploads to Supabase Storage)
   - [ ] Select location on map
   - [ ] Submit creates report with success toast
   - [ ] Report appears in home feed

3. Report Interaction
   - [ ] Report detail page loads at /report/[id]
   - [ ] Photo, map, status, category all display correctly
   - [ ] Post a comment — appears in comment list
   - [ ] Follow the report — button toggles
   - [ ] Flag button opens modal, submit flag works

4. Status Flow
   - [ ] Report starts as "open"
   - [ ] Status can progress through acknowledged → in_progress → resolved
   - [ ] Community vote panel appears when status is "resolved"
   - [ ] 3 confirmations close the report

5. Gamification
   - [ ] Points awarded for report creation
   - [ ] Points displayed on profile
   - [ ] Badge awarded when threshold reached
   - [ ] Badge toast notification appears

6. Notifications
   - [ ] Notifications page shows activity
   - [ ] Notification for comments on followed reports
   - [ ] Notification for status changes on followed reports

7. Admin Dashboard
   - [ ] /admin loads with stats cards
   - [ ] Flagged items view shows flagged content
   - [ ] User management shows user list
   - [ ] Hide/unhide, lock/unlock, ban/unban work
   - [ ] Non-admin users are redirected

8. Mobile Experience
   - [ ] All pages render at 375px width
   - [ ] Bottom navigation works with safe area insets
   - [ ] Touch targets are adequate
   - [ ] No horizontal scroll
```

### Lighthouse Targets
| Metric | Target |
|--------|--------|
| Performance | > 80 |
| Accessibility | > 90 |
| Best Practices | > 90 |
| SEO | > 80 |

## Acceptance Criteria
- [ ] Application is deployed and accessible on Vercel production URL
- [ ] Production database is seeded with demo data
- [ ] Google OAuth authentication works in production
- [ ] Full judge flow completes without errors (create → view → comment → follow → vote → badge)
- [ ] Admin dashboard is accessible to admin users only
- [ ] All toast notifications fire correctly
- [ ] All loading skeletons display during navigation
- [ ] All empty states display when no data exists
- [ ] Application renders correctly on mobile (375px)
- [ ] No console errors in production
- [ ] Lighthouse mobile Performance score > 80
- [ ] Lighthouse Accessibility score > 90
- [ ] README.md deployment instructions are accurate
