# E3-S5: Build Report Card Component

## Description
Build the report card component as a Server Component for the home feed. Each card displays a photo thumbnail, status pill, category tag, title, description preview, area name, follower count, creator info, and relative time. Also create the reusable `StatusPill`, `CategoryTag`, and date utility.

## Dependencies
- Stories: E1-S5
- Files: `src/styles/globals.css` (CSS tokens), `src/lib/utils/cn.ts`, `src/lib/constants/categories.ts`, `src/lib/constants/statuses.ts`

## Tasks
1. `src/components/reports/report-card.tsx`: Create Server Component displaying report data in a card layout with photo thumbnail (16:9), status pill, category tag, title, description preview, area name, follower count, creator avatar + name, and time ago
2. `src/components/reports/status-pill.tsx`: Create Server Component for colored status indicator pill
3. `src/components/reports/category-tag.tsx`: Create Server Component for category tag badge
4. `src/lib/utils/date.ts`: Create `timeAgo` utility function for relative date formatting

## Implementation Notes

### Report Card (`src/components/reports/report-card.tsx`)
```typescript
import Image from 'next/image';
import Link from 'next/link';
import { MapPin, Users } from 'lucide-react';

import { Card } from '@/components/ui/card';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { StatusPill } from './status-pill';
import { CategoryTag } from './category-tag';
import { timeAgo } from '@/lib/utils/date';

import type { Report } from '@/lib/types';

interface ReportCardProps {
  report: Report;
}

export function ReportCard({ report }: ReportCardProps) {
  return (
    <Link href={`/report/${report.id}`}>
      <Card className="overflow-hidden transition-colors hover:bg-accent/50">
        {/* Photo Thumbnail */}
        {report.photo_url && (
          <div className="relative aspect-video w-full">
            <Image
              src={report.photo_url}
              alt={report.title}
              fill
              className="object-cover"
              sizes="(max-width: 768px) 100vw, 50vw"
            />
          </div>
        )}

        <div className="space-y-3 p-4">
          {/* Status + Category Row */}
          <div className="flex items-center gap-2">
            <StatusPill status={report.status} />
            <CategoryTag category={report.category} />
          </div>

          {/* Title */}
          <h2 className="text-base font-semibold leading-tight line-clamp-2">
            {report.title}
          </h2>

          {/* Description Preview */}
          <p className="text-sm text-muted-foreground line-clamp-2">
            {report.description}
          </p>

          {/* Location */}
          {report.area_name && (
            <p className="flex items-center gap-1 text-xs text-muted-foreground">
              <MapPin className="h-3 w-3" />
              {report.area_name}
            </p>
          )}

          {/* Footer: Creator + Meta */}
          <div className="flex items-center justify-between pt-1">
            <div className="flex items-center gap-2">
              <Avatar className="h-6 w-6">
                <AvatarImage src={report.creator?.avatar_url ?? ''} />
                <AvatarFallback className="text-xs">
                  {report.creator?.full_name?.charAt(0) ?? 'U'}
                </AvatarFallback>
              </Avatar>
              <span className="text-xs text-muted-foreground">
                {report.creator?.full_name ?? 'Anonymous'}
              </span>
            </div>

            <div className="flex items-center gap-3 text-xs text-muted-foreground">
              <span className="flex items-center gap-1">
                <Users className="h-3 w-3" />
                {report.follower_count}
              </span>
              <time>{timeAgo(report.created_at)}</time>
            </div>
          </div>
        </div>
      </Card>
    </Link>
  );
}
```

### Status Pill (`src/components/reports/status-pill.tsx`)
```typescript
import { cn } from '@/lib/utils/cn';

import type { StatusValue } from '@/lib/constants/statuses';

interface StatusPillProps {
  status: StatusValue;
}

const statusConfig: Record<StatusValue, { label: string; className: string }> = {
  open: {
    label: 'Open',
    className: 'bg-[hsl(var(--status-open))]/15 text-[hsl(var(--status-open))]',
  },
  acknowledged: {
    label: 'Acknowledged',
    className: 'bg-[hsl(var(--status-acknowledged))]/15 text-[hsl(var(--status-acknowledged))]',
  },
  in_progress: {
    label: 'In Progress',
    className: 'bg-[hsl(var(--status-in-progress))]/15 text-[hsl(var(--status-in-progress))]',
  },
  resolved: {
    label: 'Resolved',
    className: 'bg-[hsl(var(--status-resolved))]/15 text-[hsl(var(--status-resolved))]',
  },
  closed: {
    label: 'Closed',
    className: 'bg-[hsl(var(--status-closed))]/15 text-[hsl(var(--status-closed))]',
  },
};

export function StatusPill({ status }: StatusPillProps) {
  const config = statusConfig[status];
  return (
    <span
      className={cn(
        'rounded-full px-2.5 py-0.5 text-xs font-semibold uppercase tracking-wider',
        config.className
      )}
    >
      {config.label}
    </span>
  );
}
```

### Category Tag (`src/components/reports/category-tag.tsx`)
```typescript
import type { CategoryValue } from '@/lib/constants/categories';

interface CategoryTagProps {
  category: CategoryValue;
}

const categoryLabels: Record<CategoryValue, string> = {
  infrastructure: 'Infrastruktur',
  cleanliness: 'Kebersihan',
  safety: 'Keselamatan',
  facilities: 'Kemudahan',
  other: 'Lain-lain',
};

export function CategoryTag({ category }: CategoryTagProps) {
  return (
    <span className="rounded-md px-2 py-1 text-xs font-medium bg-secondary text-secondary-foreground">
      {categoryLabels[category]}
    </span>
  );
}
```

### Date Utility (`src/lib/utils/date.ts`)
```typescript
const MINUTE = 60;
const HOUR = 3600;
const DAY = 86400;
const WEEK = 604800;
const MONTH = 2592000;

export function timeAgo(dateString: string): string {
  const seconds = Math.floor(
    (Date.now() - new Date(dateString).getTime()) / 1000
  );

  if (seconds < MINUTE) return 'just now';
  if (seconds < HOUR) return `${Math.floor(seconds / MINUTE)}m ago`;
  if (seconds < DAY) return `${Math.floor(seconds / HOUR)}h ago`;
  if (seconds < WEEK) return `${Math.floor(seconds / DAY)}d ago`;
  if (seconds < MONTH) return `${Math.floor(seconds / WEEK)}w ago`;
  return new Date(dateString).toLocaleDateString('en-MY', {
    day: 'numeric',
    month: 'short',
  });
}
```

### Design Specifications
- **Card**: shadcn `Card` with `overflow-hidden`, hover `bg-accent/50`
- **Photo**: `aspect-video`, `object-cover`, `rounded-t-lg` (via card overflow)
- **Status pill**: `rounded-full px-2.5 py-0.5 text-xs font-semibold uppercase tracking-wider` with status-specific background/text color
- **Category tag**: `rounded-md px-2 py-1 text-xs font-medium bg-secondary`
- **Title**: `text-base font-semibold line-clamp-2`
- **Description**: `text-sm text-muted-foreground line-clamp-2`
- **Card gap**: `space-y-3 p-4`

## Acceptance Criteria
- [ ] Report card renders with photo thumbnail (16:9 aspect ratio, object-cover)
- [ ] Status pill shows correct color and label for each status
- [ ] Status pill uses design system specs: `rounded-full px-2.5 py-0.5 text-xs font-semibold uppercase tracking-wider`
- [ ] Category tag shows Malay label with `bg-secondary` background
- [ ] Title truncates at 2 lines (`line-clamp-2`)
- [ ] Description preview truncates at 2 lines
- [ ] Area name displays with MapPin icon
- [ ] Creator avatar and name shown in footer
- [ ] Follower count shown with Users icon
- [ ] Relative time shown via `timeAgo` utility
- [ ] Card links to `/report/[id]`
- [ ] Card has hover effect (`hover:bg-accent/50`)
- [ ] All components are Server Components (no `'use client'`)
- [ ] Named exports: `ReportCard`, `StatusPill`, `CategoryTag`, `timeAgo`
